<!--
  ~ Copyright  2021 LSD Information Technology (Pty) Ltd
  ~
  ~    Licensed under the Apache License, Version 2.0 (the "License");
  ~    you may not use this file except in compliance with the License.
  ~    You may obtain a copy of the License at
  ~
  ~        http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~    Unless required by applicable law or agreed to in writing, software
  ~    distributed under the License is distributed on an "AS IS" BASIS,
  ~    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~    See the License for the specific language governing permissions and
  ~    limitations under the License.
  -->

<div class="p-grid">
  <div class="p-col-12" *ngIf="dockerSettings">

    <p-toolbar styleClass="p-mb-4">
      <ng-template pTemplate="left">
        <h5>Docker Registries</h5>
      </ng-template>
      <ng-template pTemplate="right">
        <button pButton pRipple label="Save" icon="pi pi-save" class="p-button-success p-mr-2 p-mb-2" (click)="save()" [disabled]="settingsForm.invalid"></button>
        <button pButton pRipple label="Add" icon="pi pi-plus-circle" class="p-button-plain p-mr-2 p-mb-2" (click)="addDockerRegistry()"></button>
        <button pButton pRipple label="Delete" icon="pi pi-trash" class="p-button-warning p-mr-2 p-mb-2" (click)="deleteRegistry()"></button>
      </ng-template>
    </p-toolbar>

    <form #settingsForm="ngForm">
      <div *ngIf="dockerSettings.dockerRegistries && dockerSettings.dockerRegistries.length > 0">

        <p-tabView orientation="left" [(activeIndex)]="selectedIndex">
          <p-tabPanel [header]="dockerRegistry.name ? dockerRegistry.name : '<new>'"
                      *ngFor="let dockerRegistry of dockerSettings.dockerRegistries; let i = index" [selected]="i == 0">

            <div class="p-fluid p-col-12 p-md-5">
              <div class="p-field p-float-label">
                <input pInputText id="dockerRegistryName{{i}}" [(ngModel)]="dockerSettings.dockerRegistries[i].name" name="dockerRegistryName{{i}}" required>
                <label for="dockerRegistryName{{i}}">Name</label>
              </div>
              <div class="p-field p-float-label">
                <input pInputText id="dockerServerName{{i}}" [(ngModel)]="dockerSettings.dockerRegistries[i].server" name="dockerServerName{{i}}" required>
                <label for="dockerServerName{{i}}">Server</label>
              </div>

              <div class="p-field-checkbox">
                <p-checkbox name="dockerServerSecure{{i}}" [(ngModel)]="dockerSettings.dockerRegistries[i].secure" id="dockerServerSecure{{i}}" binary="true"></p-checkbox>
                <label for="dockerServerSecure{{i}}">Secure</label>
              </div>

              <div class="p-field p-float-label" *ngIf="dockerSettings.dockerRegistries[i].secure">
                <input pInputText id="dockerUsername{{i}}" [(ngModel)]="dockerSettings.dockerRegistries[i].username" name="dockerUsername{{i}}" required>
                <label for="dockerUsername{{i}}">Username</label>
              </div>
              <i class="pi {{hideDockerPassword ? 'pi-eye-slash':'pi-eye'}}" *ngIf="dockerSettings.dockerRegistries[i].secure" style="cursor: pointer; width: 10px" (click)="hideDockerPassword = !hideDockerPassword"></i>
              <div class="p-field p-float-label" *ngIf="dockerSettings.dockerRegistries[i].secure">
                <input pInputText id="dockerPassword{{i}}" [(ngModel)]="dockerSettings.dockerRegistries[i].password" name="dockerPassword{{i}}"
                       [type]="hideDockerPassword ? 'password' : 'text'"
                       required>
                <label for="dockerPassword{{i}}">Password</label>
              </div>

            </div>

          </p-tabPanel>
        </p-tabView>

      </div>
    </form>

  </div>
</div>
